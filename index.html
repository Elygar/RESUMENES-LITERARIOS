<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Audiolibros y Res√∫menes en Video de Obras Literarias | Biblioteca Digital</title>
  <meta name="description" content="Descubre res√∫menes en video de las mejores obras literarias y audiolibros. Aprende r√°pido con an√°lisis de libros cl√°sicos y contempor√°neos organizados por g√©nero." />
  <meta name="keywords" content="audiolibros, res√∫menes de libros, obras literarias, videos educativos, an√°lisis literario, libros resumidos, literatura cl√°sica, libros contempor√°neos" />
  <meta name="author" content="Audiolibros" />

  <link rel="icon" type="image/x-icon" href="favicon.ico" />

  <style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 0; background: #f4f1fa; color: #333; display: flex; flex-direction: column; min-height: 100vh; }
    header { background: linear-gradient(90deg, #5e35b1, #311b92); color: white; padding: 20px; text-align: center; position: relative; }
    header h1 { margin: 0; font-size: 2rem; font-weight: 600; }
    .menu-btn { position: absolute; left: 20px; top: 10px; cursor: pointer; width: 50px; height: 50px; padding: 5px; transition: transform 0.2s ease; }
    .menu-btn:hover { transform: scale(1.1); }
    .menu-btn img { width: 100%; height: 100%; object-fit: contain; }
    .menu-btn.hidden { display: none; }
    .search-container { text-align: center; margin: 20px; }
    .search-container input { width: 90%; max-width: 500px; padding: 12px; font-size: 16px; border: 1px solid #ccc; border-radius: 25px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .video-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; padding: 20px; max-width: 1200px; margin: auto; }
    .card { background: white; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); overflow: hidden; transition: transform 0.2s ease; }
    .card:hover { transform: translateY(-5px); }
    .card img { width: 100%; height: 180px; object-fit: cover; }
    .card-content { padding: 15px; }
    .card-content h3 { margin: 0 0 5px; font-size: 1.2rem; color: #4527a0; }
    .btn { display: inline-block; margin-top: 10px; padding: 8px 16px; background: #5e35b1; color: white; border: none; border-radius: 25px; cursor: pointer; font-size: 0.9rem; transition: background 0.2s ease; }
    .btn:hover { background: #311b92; }
    .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 1000; justify-content: center; align-items: center; }
    .overlay-content { position: relative; width: 90%; max-width: 900px; background: #1a1a1a; border-radius: 12px; overflow: hidden; max-height: 90vh; overflow-y: auto; }
    .overlay iframe { width: 100%; height: 500px; border: none; }
    .close-btn { position: absolute; top: 10px; right: 10px; background: crimson; color: white; border: none; font-size: 20px; padding: 5px 10px; border-radius: 50%; cursor: pointer; }
    .sidebar-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1100; }
    .sidebar { position: fixed; top: 0; left: -290px; width: 250px; height: 100%; background: #311b92; color: white; padding: 20px; transition: left 0.3s ease; z-index: 1200; overflow-y: auto; }
    .sidebar.active { left: 0; }
    .genre-tags { display: flex; flex-wrap: wrap; gap: 4px; margin-top: 15px; }
    .genre-tag { border: 1px solid white; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 14px; text-transform: uppercase; transition: all 0.2s ease; }
    .genre-tag:hover, .genre-tag.active { background: white; color: #311b92; }
    footer { background: #311b92; color: #fff; text-align: center; padding: 15px; margin-top: auto; }
    footer a { color: #ffeb3b; text-decoration: none; margin: 0 8px; }
  </style>
</head>

<body>
  <header>
    <h1>RES√öMENES LITERARIOS</h1>
    <div class="menu-btn" id="menuBtn" onclick="toggleMenu()" aria-label="Abrir men√∫ de g√©neros">
      <img src="favicon.png" alt="Men√∫ Audiolibros">
    </div>
  </header>

  <main>
    <div class="search-container">
      <!-- Evita Enter con onkeypress -->
      <input type="search" id="searchInput" placeholder="Buscar por t√≠tulo, autor o sinopsis..." aria-label="Buscar libros" autocomplete="off" onkeypress="return event.key !== 'Enter'">
    </div>

    <section class="video-list" id="videoList"></section>
    <nav id="pagination"></nav>
  </main>

  <div class="overlay" id="videoOverlay">
    <div class="overlay-content">
      <button class="close-btn" onclick="closeOverlay()">‚úñ</button>
      <div id="player"></div>
      <article class="video-info" id="videoInfo"></article>
      <section class="related-videos" id="relatedVideos"></section>
    </div>
  </div>

  <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleMenu()"></div>
  <aside class="sidebar" id="sidebar">
    <h4><center>G√âNEROS</center></h4>
    <div id="genreList" class="genre-tags"></div>
  </aside>

  <footer>
    <p>&copy; 2025 Audiolibros - Res√∫menes en Video de Obras Literarias.</p>
  </footer>

  <script>
    // üîí Evita que cualquier acci√≥n dispare un "submit" y recargue
    document.addEventListener('submit', e => e.preventDefault());

    let videos = [];
    let currentPage = 1;
    const itemsPerPage = 30;

    fetch('videos.json?t=' + new Date().getTime())
      .then(res => res.json())
      .then(data => {
        videos = data;
        mostrarPagina(1);
        cargarGeneros();
      })
      .catch(err => console.error('Error cargando JSON:', err));

    function mostrarPagina(page) {
      currentPage = page;
      const lista = document.getElementById("videoList");
      lista.innerHTML = "";
      const start = (page - 1) * itemsPerPage;
      const end = start + itemsPerPage;
      const paginaVideos = videos.slice(start, end);

      paginaVideos.forEach(video => {
        lista.innerHTML += `
          <article class="card">
            <img src="https://img.youtube.com/vi/${video.id}/hqdefault.jpg" alt="Resumen de ${video.titulo}">
            <div class="card-content">
              <h3>${video.titulo}</h3>
              <p><strong>Autor:</strong> ${video.autor}</p>
              <p>${video.sinopsis}</p>
              <button class="btn" onclick="openOverlay('${video.id}')">Ver m√°s</button>
            </div>
          </article>`;
      });

      generarPaginacion();
    }

    function generarPaginacion() {
      const totalPages = Math.ceil(videos.length / itemsPerPage);
      const pagContainer = document.getElementById("pagination");
      pagContainer.innerHTML = "";
      for (let i = 1; i <= totalPages; i++) {
        const btn = document.createElement("button");
        btn.textContent = i;
        btn.onclick = () => mostrarPagina(i);
        if (i === currentPage) btn.classList.add("active");
        pagContainer.appendChild(btn);
      }
    }

    function openOverlay(videoId) {
      const videoActual = videos.find(v => v.id === videoId);
      document.getElementById("videoOverlay").style.display = "flex";
      document.getElementById("player").innerHTML = `
        <iframe width="100%" height="500"
          src="https://www.youtube.com/embed/${videoId}?autoplay=1"
          allow="autoplay; encrypted-media" allowfullscreen></iframe>`;
      mostrarInfoVideo(videoActual);
      mostrarVideosRelacionados(videoActual);
    }

    function closeOverlay() {
      document.getElementById("videoOverlay").style.display = "none";
      document.getElementById("player").innerHTML = "";
    }

    document.getElementById('searchInput').addEventListener('keyup', function() {
      const filter = this.value.toLowerCase();
      const filtrados = videos.filter(video =>
        video.titulo.toLowerCase().includes(filter) ||
        video.autor.toLowerCase().includes(filter) ||
        video.sinopsis.toLowerCase().includes(filter)
      );
      mostrarResultados(filtrados);
    });

    function mostrarResultados(listaVideos) {
      const lista = document.getElementById("videoList");
      lista.innerHTML = "";
      listaVideos.forEach(video => {
        lista.innerHTML += `
          <article class="card">
            <img src="https://img.youtube.com/vi/${video.id}/hqdefault.jpg" alt="Resumen de ${video.titulo}">
            <div class="card-content">
              <h3>${video.titulo}</h3>
              <p><strong>Autor:</strong> ${video.autor}</p>
              <p>${video.sinopsis}</p>
              <button class="btn" onclick="openOverlay('${video.id}')">Ver m√°s</button>
            </div>
          </article>`;
      });
      document.getElementById("pagination").innerHTML = "";
    }

    function toggleMenu() {
      const sidebar = document.getElementById('sidebar');
      const overlay = document.getElementById('sidebarOverlay');
      const menuBtn = document.getElementById('menuBtn');
      sidebar.classList.toggle('active');
      overlay.style.display = sidebar.classList.contains('active') ? 'block' : 'none';
      menuBtn.classList.toggle('hidden', sidebar.classList.contains('active'));
    }

    function cargarGeneros() {
      const contenedor = document.getElementById("genreList");
      contenedor.innerHTML = "";

      const tagTodos = document.createElement("div");
      tagTodos.textContent = "TODOS";
      tagTodos.className = "genre-tag";
      tagTodos.onclick = () => filterGenre("all", tagTodos);
      contenedor.appendChild(tagTodos);

      let generos = new Set();
      videos.forEach(video => {
        video.genero.split(",").forEach(g => generos.add(g.trim().toUpperCase()));
      });

      [...generos].sort().forEach(g => {
        const tag = document.createElement("div");
        tag.textContent = g;
        tag.className = "genre-tag";
        tag.onclick = () => filterGenre(g.toLowerCase(), tag);
        contenedor.appendChild(tag);
      });
    }

    function filterGenre(genre, el) {
      document.querySelectorAll(".genre-tag").forEach(tag => tag.classList.remove("active"));
      if (el) el.classList.add("active");

      const filtrados = (genre === "all") ? videos : videos.filter(video => video.genero.toLowerCase().includes(genre));
      mostrarResultados(filtrados);
    }
  </script>
</body>
</html>
