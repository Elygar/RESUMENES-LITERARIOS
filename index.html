<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Res√∫menes Literarios y Audiolibros | Biblioteca Digital</title>
  <meta name="description" content="Explora res√∫menes literarios y audiolibros organizados por g√©nero, autor y tema. Encuentra tus obras favoritas y aprende de manera r√°pida y entretenida.">
  <meta name="keywords" content="res√∫menes literarios, audiolibros, an√°lisis de libros, literatura, novelas, poes√≠a, cl√°sicos">
  <meta name="author" content="Biblioteca Digital">
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <style>
    body { font-family: 'Segoe UI', Tahoma, sans-serif; margin: 0; background: #f4f1fa; color: #333; display: flex; flex-direction: column; min-height: 100vh; }
    header { background: linear-gradient(90deg, #5e35b1, #311b92); color: white; padding: 20px; text-align: center; position: relative; }
    header h1 { margin: 0; font-size: 2rem; }
    .menu-btn { position: absolute; left: 20px; top: 10px; cursor: pointer; width: 45px; height: 45px; }
    .menu-btn img { width: 100%; height: 100%; object-fit: contain; }
    .search-container { text-align: center; margin: 20px; }
    .search-container input { width: 90%; max-width: 500px; padding: 12px; font-size: 16px; border: 1px solid #ccc; border-radius: 25px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .video-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; padding: 20px; max-width: 1200px; margin: auto; }
    .card { background: white; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); overflow: hidden; transition: transform 0.2s ease; }
    .card:hover { transform: translateY(-5px); }
    .card img { width: 100%; height: 180px; object-fit: cover; }
    .card-content { padding: 15px; }
    .btn { display: inline-block; margin-top: 10px; padding: 8px 16px; background: #5e35b1; color: white; border: none; border-radius: 25px; cursor: pointer; transition: background 0.2s ease; }
    .btn:hover { background: #311b92; }
    .sidebar { position: fixed; top: 0; left: -290px; width: 250px; height: 100%; background: #311b92; color: white; padding: 20px; transition: left 0.3s ease; z-index: 1200; overflow-y: auto; }
    .sidebar.active { left: 0; }
    .genre-tag { border: 1px solid white; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 14px; text-transform: uppercase; margin: 3px; transition: all 0.2s ease; }
    .genre-tag:hover, .genre-tag.active { background: white; color: #311b92; }
    .no-results { text-align: center; padding: 40px; font-size: 1.2rem; color: #777; }
    footer { background: #311b92; color: white; text-align: center; padding: 15px; margin-top: auto; }
  </style>
</head>
<body>
  <header>
    <h1>RES√öMENES LITERARIOS</h1>
    <div class="menu-btn" onclick="toggleMenu()"><img src="favicon.png" alt="Men√∫"></div>
  </header>

  <main>
    <div class="search-container">
      <input type="search" id="searchInput" placeholder="Buscar por t√≠tulo, autor o g√©nero..." autocomplete="off" onkeypress="return event.key !== 'Enter'">
    </div>

    <section class="video-list" id="videoList"></section>
    <div id="noResults" class="no-results" style="display:none;">No se encontraron resultados.</div>
  </main>

  <aside class="sidebar" id="sidebar">
    <h4><center>G√âNEROS</center></h4>
    <div id="genreList" class="genre-tags"></div>
  </aside>

  <footer><p>&copy; 2025 Biblioteca Digital</p></footer>

  <script>
    let videos = [];
    let currentGenre = "all";

    fetch("videos.json?t=" + new Date().getTime())
      .then(r => r.json())
      .then(data => {
        videos = data;
        mostrarVideos(videos);
        cargarGeneros();
      });

    function toggleMenu() {
      document.getElementById('sidebar').classList.toggle('active');
    }

    async function mostrarVideos(lista) {
      const cont = document.getElementById("videoList");
      const noRes = document.getElementById("noResults");
      cont.innerHTML = "";
      if (lista.length === 0) {
        noRes.style.display = "block";
        return;
      }
      noRes.style.display = "none";
      const fragment = document.createDocumentFragment();
      lista.forEach(v => {
        const art = document.createElement("article");
        art.className = "card";
        art.innerHTML = `
          <img src="https://img.youtube.com/vi/${v.id}/hqdefault.jpg" alt="${v.titulo}">
          <div class="card-content">
            <h3>${v.titulo}</h3>
            <p><strong>Autor:</strong> ${v.autor}</p>
            <p>${v.sinopsis}</p>
            <button class="btn" onclick="openVideo('${v.id}')">Ver m√°s</button>
          </div>`;
        fragment.appendChild(art);
      });
      cont.appendChild(fragment);
    }

    function openVideo(id) {
      window.open(`https://www.youtube.com/watch?v=${id}`, "_blank");
    }

    function cargarGeneros() {
      const lista = document.getElementById("genreList");
      lista.innerHTML = "";
      const tagTodos = document.createElement("div");
      tagTodos.textContent = "TODOS";
      tagTodos.className = "genre-tag active";
      tagTodos.onclick = () => filterGenre("all", tagTodos);
      lista.appendChild(tagTodos);

      const generos = new Set();
      videos.forEach(v => v.genero.split(",").forEach(g => generos.add(g.trim().toUpperCase())));
      [...generos].sort().forEach(g => {
        const tag = document.createElement("div");
        tag.textContent = g;
        tag.className = "genre-tag";
        tag.onclick = () => filterGenre(g.toLowerCase(), tag);
        lista.appendChild(tag);
      });
    }

    function filterGenre(genre, el) {
      document.querySelectorAll(".genre-tag").forEach(t => t.classList.remove("active"));
      el.classList.add("active");
      currentGenre = genre;

      if (genre === "all") {
        mostrarVideos(videos);
      } else {
        const filtrados = videos.filter(v => v.genero.toLowerCase().includes(genre));
        mostrarVideos(filtrados);
      }
      toggleMenu();
    }

    document.getElementById("searchInput").addEventListener("input", e => {
      const texto = e.target.value.toLowerCase().trim();
      if (texto === "") {
        if (currentGenre === "all") mostrarVideos(videos);
        else filterGenre(currentGenre, document.querySelector(`.genre-tag.active`));
        return;
      }

      // üîç b√∫squeda tipo ‚Äútag‚Äù inteligente
      const filtrados = videos.filter(v =>
        v.titulo.toLowerCase().includes(texto) ||
        v.autor.toLowerCase().includes(texto) ||
        v.sinopsis.toLowerCase().includes(texto) ||
        v.genero.toLowerCase().includes(texto)
      );
      mostrarVideos(filtrados);
    });
  </script>
</body>
</html>
